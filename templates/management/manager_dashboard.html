{% extends 'base.html' %}

{% block content %}
<div class="container section">
    <div class="dashboard-header">
        <h1>Manager Dashboard</h1>
        <div class="dashboard-nav">
            <a href="{% url 'analytics_report' %}" class="btn btn-primary">View Analytics</a>
            <a href="/admin/" class="btn btn-outline">Admin Panel</a>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_clients }}</h3>
            <p>Total Clients</p>
        </div>
        <div class="stat-card">
            <h3>{{ total_bookings }}</h3>
            <p>Total Bookings</p>
        </div>
        <div class="stat-card">
            <h3>{{ confirmed_bookings }}</h3>
            <p>Confirmed Bookings</p>
        </div>
        <div class="stat-card">
            <h3>${{ total_revenue }}</h3>
            <p>Total Revenue</p>
        </div>
    </div>

    <div class="dashboard-grid">
        <div class="dashboard-card">
            <h3>Recent Bookings</h3>
            {% for booking in recent_bookings %}
            <div class="item">
                <strong>{{ booking.customer_name }}</strong> - {{ booking.activity.name }}
                <span class="date">{{ booking.date }}</span>
            </div>
            {% endfor %}
        </div>

        <div class="dashboard-card">
            <h3>Recent Payments</h3>
            {% for payment in recent_payments %}
            <div class="item">
                <strong>${{ payment.amount }}</strong> - {{ payment.booking.customer_name }}
                <span class="status {{ payment.status|lower }}">{{ payment.status }}</span>
            </div>
            {% endfor %}
        </div>
        
        <div class="dashboard-card">
            <h3>All Clients</h3>
            {% for client in all_clients %}
            <div class="item">
                <strong>{{ client.user.get_full_name|default:client.user.username }}</strong>
                <span class="date">{{ client.user.email }}</span>
            </div>
            {% empty %}
            <p>No clients registered yet.</p>
            {% endfor %}
        </div>
    </div>
</div>

<style>
.dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
.dashboard-nav { display: flex; gap: 1rem; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
.stat-card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 3px 10px var(--shadow); text-align: center; }
.stat-card h3 { font-size: 2rem; color: var(--primary-green); margin-bottom: 0.5rem; }
.dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; }
.dashboard-card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 3px 10px var(--shadow); }
.item { display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--accent-green); }
.status.paid { color: green; }
.status.pending { color: orange; }
</style>
{% endblock %}